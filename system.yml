---
- hosts: all
  vars:
    new_user_name_list:
      - youcefadmin
      - youcefadmin2
      - youcefadmin3
    ssh_authorized_user_list:
      - youcefadmin
      - youcefadmin2
      - youcefadmin3

  #vars prompt si on veut
  #vars_prompt:
  #  - name: new_user_name
  #    prompt: "What is the username of the new user?"
  #    private: no

  #  - name: ssh_authorized_user
  #    prompt: "What is the username of the user to authorize with SSH?"
  #    private: no

  tasks:
  - name: Add the user new_user_name
    become: true
    user:
      name: "{{ item }}"
      shell: /bin/bash
    with_items:
      - "{{ new_user_name_list }}"

  - name: Deploy package htop
    become: true
    package:
      name: htop
      state: present

  - name: Deploy package vim
    become: true
    package:
      name: vim
      state: present

  - name: SSH authorized key for ssh_authorized_user
    become: true
    authorized_key:
      user: "{{ item }}"
      state: present
      key: "{{ lookup('file', 'keys/id_rsa.pub') }}"
    with_items:
      - "{{ ssh_authorized_user_list }}"
